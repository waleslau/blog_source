---
title: 零成本为网站增加国内外访客分流功能
abbrlink: 67ec153b
date: 2025-12-29 11:55:31
updated: 2025-12-29 18:09:01
tags:
  - cloudflare
  - dns
  - dnspod
  - cdn
---

## 前言

本文旨在在不增加成本的情况下，让国内用户访问更快、国外用户体验更稳。只需要配合使用两个域名，通过 Cloudflare 自定义主机名 + 国内 DNS 厂商分流解析 + 国内 CDN 回源/直接访问国内源站，就可以实现“国内走国内 CDN/直连、国外走 Cloudflare”的效果。

## 前置条件

- 开启 Cloudflare for SaaS 的 Cloudflare 账号（需绑定信用卡，支持银联信用卡）
- DNSPod 账号（支持境内外分流解析）
- 主域名（网站使用的域名）
- 中间域名（访客对于中间域名无感知）

## 配置步骤

### 1. 在 DNSPod 添加记录

必须要添加默认线路的纪录（指向哪里无所谓，可配置为国内源站服务器），然后分别添加境内、境外线路

![在 DNSPod 添加记录](https://cdn.oopsky.top/images/2025/12/251229175039-214a112cfe7ace721f31fe9423e1833f.webp)

### 2. 在 Cloudflare 给中间域名添加解析记录

这里的名称随意

![给中间域名添加解析记录](https://cdn.oopsky.top/images/2025/12/251229175057-dbe617fa8b794afded67bb78691c7517.webp)

### 3. 在 Cloudflare 配置回退源和自定义主机名

位置：Cloudflare -> SSL/TLS -> 自定义主机名

![配置回退源和自定义主机名](https://cdn.oopsky.top/images/2025/12/251229175109-51f8297d8f61112322b6fa412988c723.webp)

## 检查效果

![检查效果](https://cdn.oopsky.top/images/2025/12/251229175126-8554cf8f11324364ac98bcf5025713e2.webp)

这里使用的工具是：<https://www.itdog.cn/ping>

## 其他

腾讯云 EdgeOne 的免费套餐目前开放限量内测，2026 年 3 月 31 日前都有机会上车，如果 Cloudflare 绑卡有困难可以考虑一下它，我上面的截图里 DNSPod 默认线路指向的就是它，启用它需要暂停上面在 DNSPod 创建的境内境外分流解析记录，还需要域名已备案。  
活动链接：<https://cloud.tencent.com/act/pro/eo-freeplan?from=28412#choujiang>
